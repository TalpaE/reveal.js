<!doctype html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">

  <title>reveal.js</title>

  <link rel="stylesheet" href="dist/reset.css">
  <link rel="stylesheet" href="dist/reveal.css">
  <link rel="stylesheet" href="dist/theme/white.css"> <!-- perhaps also simple -->

  <!-- Theme used for syntax highlighted code -->
  <link rel="stylesheet" href="plugin/highlight/monokai.css">
  <style !important>
    /* .katex-scale { display:inline-block; transform-origin: left; transform: scale(0.5); vertical-align: bottom; line-height: 1; } */
    .katex-centered {
      text-align: left;
    }

    .math-small .katex,
    .math-small .katex-display {
      font-size: var(--size, 1);
    }

    .reveal .katex .reveal .katex-display {
      font-size: 0.5em;
    }

    .katex-wrap {
      display: inline-block;
      transform-origin: center center;
      transform: scale(var(--kscale, 1));
      will-change: transform, opacity;
      /* hint for smoother GPU animation */
      text-align: center;
    }

    .slide-grid {
      display: flex;
      flex-direction: column;
      height: 100%;
      padding: 1rem 2rem;
      box-sizing: border-box;
    }

    /* top headings (stacked) */
    .top-headings {
      text-align: center;
      margin-bottom: 0.6rem;
    }

    .top-headings h1 {
      margin: 0;
      font-size: 1.6rem;
    }

    .top-headings h2 {
      margin: 0;
      font-size: 1.0rem;
      color: #666;
      font-weight: 400;
    }

    /* grid for images: two columns, two rows */
    .image-grid {
      display: grid;
      grid-template-columns: repeat(2, 1fr);
      grid-auto-rows: 1fr;
      gap: 0.75rem;
      flex: 1;
      /* fill remaining vertical space */
      align-items: stretch;
    }

    /* each cell */
    .grid-item {
      background: rgba(0, 0, 0, 0.00);
      border-radius: 6px;
      overflow: hidden;
      display: flex;
      flex-direction: column;
    }

    /* make the image fill the cell while preserving aspect ratio */
    .grid-item img {
      width: 100%;
      height: 100%;
      object-fit: contain;
      /* "cover" if you prefer cropping */
      display: block;
    }

    /* optional caption */
    .grid-item figcaption {
      padding: 0.4rem;
      font-size: 0.85rem;
      text-align: center;
      background: rgba(255, 255, 255, 0.6);
    }

    /* responsive tweak for very narrow screens */
    @media (max-width: 800px) {
      .image-grid {
        grid-template-columns: 1fr;
        grid-auto-rows: auto;
      }
    }

    .top-bar {
      display: flex;
      justify-content: space-between;
      align-items: flex-end;
      margin-bottom: 0.6rem;
    }
  </style>
</head>

<body>
  <div class="reveal">
    <div class="slides">
      <section>
        <h6>Embedded Excited-State Geometry Optimizations</h6>
        <br>
        Anton Rikus<br><br>
        26.11.2025
      </section>
      <section>
        <h2>Strengths</h2>
        <ul class="fragmented-lists">
          <li>computational savings</li>
          <li>simpler targeting of local excited states</li>
        </ul>
      </section>

      <section>
        <section>
          <h3>Theoretical Background</h3>
          <ul class="fragmented-lists">
            <li>subsystem TDDFT gradients</li>
            <li>framework for embedded geometry optimizations</li>
          </ul>
          <!-- \[\begin{aligned} \dot{x} &amp; = \sigma(y-x) \\ \dot{y} &amp; = \rho x - y -
					xz \\ \dot{z} &amp; = -\beta z + xy \\
					&amp; \cdot\end{aligned} \\
					 \] -->
        </section>

        <section>
          <h3>Subsystem TDDFT Gradients</h3>
        </section>
        <section>
          <span class="math-small" style="--size:1.0em">
            \[ \begin{aligned} G[X, Y, \omega] &= [X^\mathrm{T} \; Y^\mathrm{T}] \begin{bmatrix} A & B \\ B & A
            \end{bmatrix}
            \begin{bmatrix} X \\ Y \end{bmatrix} \\ &\hphantom{=}- \omega \left( [X^\mathrm{T} \; Y^\mathrm{T}]
            \begin{bmatrix} X \\ -Y \end{bmatrix} - 1 \right) \end{aligned} \]</span>
          <p class="fragment" data-fragment-index="1"> <span class="math-small" style="--size:1.0em"> \[ \begin{aligned}
              A_{ia,jb} &= F_{ab}
              \delta_{ji} - F_{ij}
              \delta_{ab} + (ia|jb) + (ia|f^\mathrm{xc}|jb)\\
              &\hphantom{=} \htmlClass{fragment highlight-red}{+ (ia|f^\mathrm{naddxc}|jb) + (ia|f^\mathrm{naddkin}|jb)}
              \\
              B_{ia,jb} &= (ia|bj) + (ia|f^\mathrm{xc}|bj)\\
              &\hphantom{=} \htmlClass{fragment highlight-red}{+ (ia|f^\mathrm{naddxc}|bj) +
              (ia|f^\mathrm{naddkin}|bj)} \end{aligned} \] </span> </p>
          <span style="font-size:0.4em; color:darkgreen">F. Furche, R. Ahlrichs, <span style="font-style:italic">J.
              Chem. Phys.</span> 117 (2002), 7433.</span><br>
          <span class="fragment" data-fragment-index="1"
            style="font-size:0.4em; color:darkgreen; margin-top:-1px; display:block">A. Kovyrshin, J.
            Neugebauer, <span style="font-style:italic">Phys. Chem. Chem. Phys.</span> 18 (2016), 20955.</span>
        </section>
        <section>
          <span class="math-small" style="--size:1.0em"> \[ \begin{aligned} A_{ia,jb} &= F_{ab} \delta_{ji} - F_{ij}
            \delta_{ab} + (ia|jb) +
            \htmlClass{data-id="equation1"}{\color{#ff2c2d}{(ia|f^\mathrm{combxc}|jb)}} \\
            B_{ia,jb} &= (ia|bj) + \color{#ff2c2d}{(ia|f^\mathrm{combxc}|bj)}
            \end{aligned} \] </span>
        </section>
        <section data-auto-animate>
          <span class="math-small" style="--size:0.9em">
            \[ \begin{aligned} L[X,Y,\omega,C,Z,W] &= G[X,Y,\omega] + \sum_{ia} Z_{ia} \htmlClass{fragment
            highlight-red}{F_{ia}} - \sum_{pq, p \leq q} W_{pq} \left(S_{pq} - \delta_{pq} \right) \end{aligned} \]
          </span>
          <span class="math-small fragment" data-fragment-index="1" style="--size:0.9em">
            \[ \begin{aligned} L^\xi &= \sum_{\mu\nu} \left[ h_{\mu\nu}^\xi + v_{\mu\nu}^{\mathrm{xc}(\xi)} +
            \htmlClass{fragment highlight-red}{v_{\mu\nu}^{\mathrm{emb}(\xi)}} \right] P_{\mu\nu} +
            \sum_{\mu\nu\kappa\lambda} (\mu\nu|\kappa\lambda)^\xi \Gamma_{\mu\nu\kappa\lambda} - \sum_{\mu\nu}
            S_{\mu\nu}^\xi W_{\mu\nu} \\
            & \hphantom{=} + \sum_{\mu\nu\kappa\lambda} (X+Y)_{\mu\nu} (X+Y)_{\kappa\lambda}
            \htmlData{fragment-index="2"}{\htmlClass{fragment
            highlight-red}{f_{\mu\nu\kappa\lambda}^{\mathrm{combxc}(\xi)}}} \end{aligned} \]
          </span>
          <span class="fragment" data-fragment-index="5">
            $ v_{\mu\nu}^{\mathrm{emb}(\xi)}$ <span data-id="sentence"> contains combined xc terms (potential and
              kernel) and inter-subsystem
              electrostatic interactions</span>
          </span>
        </section>
        <section data-auto-animate>
          <h3>Embedded Geometry Optimizations</h3>
        </section>
        <section data-auto-animate>
          <h3>Embedded Geometry Optimizations</h3>
          <ul>
            <li>additional distinction: geometrically "active" and "passive" </li>
            <ul>
              <!-- monospace style -->
              <li class="fragment"><span style="font-family: monospace;">GeometryOptimizationTask</span>: <span
                  style="font-family: monospace;">act</span> subsystems are optimized, <span
                  style="font-family: monospace;">env</span> subsystems not</li>
              <li class="fragment">all subsystems relaxed electronically</li>
            </ul>
            <li class="fragment">uncoupled frozen-density embedding (FDEu) approximation for total system?</li>
            <li class="fragment">otherwise: state-specific embedding possible</li>
          </ul>
        </section>
      </section> <!-- end of theoretical background -->
      <section>
        <h3>Nonadditive Dispersion</h3>
        <span class="math-small" style="--size:0.8em">
          \[ \begin{aligned} E^\mathrm{disp,tot} &= \sum_I E^\mathrm{disp}_\mathrm{xcparam}[\{R_I\}] +
          \underbrace{E^\mathrm{disp}_\mathrm{naddxcparam}[\{R_\mathrm{tot}\}] - \sum_I
          E^\mathrm{disp}_\mathrm{naddxcparam}[\{R_I\}] }_{E^\mathrm{disp}_\mathrm{nadd}} \end{aligned} \]
        </span>
        <span class="math-small fragment" style="--size:0.8em">
          \[ \begin{aligned} G^\mathrm{disp,tot}_\xi &= \sum_I G^\mathrm{disp,xcparam}_{I,\xi} +
          \underbrace{\htmlClass{fragment highlight-red}{G^\mathrm{disp,naddxcparam}_\xi} - \sum_I
          G^\mathrm{disp,naddxcparam}_{I,\xi}}_{G^\mathrm{disp,nadd}_\xi} \end{aligned} \]
        </span>
        <ul>
          <li class="fragment" data-id="3">gradient contribution used to be incorrect in <span
              style="font-variant:small-caps">Serenity</span> </li>
        </ul>
      </section>
      <!-- <section> -->
      <!-- <span style="font-size:0.4em; color:darkgreen">A. Zech, N. Ricardi, S. Prager, A. Dreuw, T. A. Wesołowski, <span style="font-style:italic">J. Chem. Theory Comput.</span> 14 (2018), 4028.</span> -->
      <!-- </section> -->
      <section>
        <h3>Computational Details</h3>
        def2-TZVP, default grid settings (2/4/4), PBE0/PBE/revAPBEK, D3(BJ), TDA, IRed, RFO
      </section>
      <section>
        <h6>Parallelization</h6>
        <img src="media/bench_input.png" data-preview-image>
        <!-- make the next sentence smaller -->
        <p style="font-size:0.4em; color:darkgreen">Computational Details: def2-TZVP, default grid settings
          (2/4/4), PBE0/PBE/revAPBEK, D3(BJ), TDA, 4 excitations, 1 gradient</p>
      </section>

      <section>
        <div class="slide-grid">
          <div class="top-bar">
            <span>Hole density</span>
            <span style="font-size:0.8em">Isovalue: 0.0025</span>
            <span>Particle density</span>
          </div>

          <div class="image-grid">
            <figure class="grid-item">
              <img src="media/hole_fromtop.png" alt="description 1" data-preview-image>
            </figure>

            <figure class="grid-item">
              <img src="media/particle_fromtop.png" alt="description 3" data-preview-image>
            </figure>

            <!-- <span style="display:block; margin-top:-0.5em;"></span> -->

            <figure class="grid-item">
              <img src="media/hole_sideways.png" alt="description 2" data-preview-image>
            </figure>

            <figure class="grid-item">
              <img src="media/particle_sideways.png" alt="description 4" data-preview-image>
            </figure>
          </div>
        </div>
      </section>
      <section>
        Relaxed difference density (S$_1$)
        <div class="slide-grid">

          <div class="image-grid">
            <figure class="grid-item">
              <img src="media/diffdens_fromtop.png" alt="description 1" data-preview-image>
            </figure>

            <figure class="grid-item">
              <img src="media/diffdens_sideways.png" alt="description 3" data-preview-image>
            </figure>
          </div>
        </div>
      </section>
      <!-- 
			<section>
				<h4>S$_1$ optimization with water geometry frozen (IRed, RFO) </h4>
				<video controls loop data-src="media/emb.mp4" data-preview-video data-preview-fit="contain"></video>
			</section> -->
      <section>
        <h4>S$_1$ supersystem optimization </h4>
        <video id="emb_act-vid" controls loop preload="metadata" data-src="media/super.mp4" data-preview-video
          data-preview-fit="contain"></video>
        <script>
          const v = document.getElementById('emb_act-vid');
          // 0.5 = half speed, 1 = normal, 2 = double speed
          v.addEventListener('loadedmetadata', () => {
            v.playbackRate = 0.25;
          });
        </script>
      </section>
      <section>
        <h4>S$_1$ embedded optimization (water frozen)</h4>
        <video id="emb_act-vid" controls preload="metadata" data-src="media/emb.mp4" data-preview-video
          data-preview-fit="contain"></video>
        <script>
          const v = document.getElementById('emb_act-vid');
          // 0.5 = half speed, 1 = normal, 2 = double speed
          v.addEventListener('loadedmetadata', () => {
            v.playbackRate = 0.01;
          });
        </script>
      </section>
      <section>
        <h4>Comparison</h4>
        <ul class="fragmented-lists">
          <li>RMSD of optimized coordinates vs. supersystem (after Kabsch algorithm): 0.05 Å</li>
          <li>excitation energy: 3.845 eV  (embedded) vs 3.801 eV (supersystem)</li>
          <li>electronic character retained in optimization</li><br>
          <li>BFGS (cart) 19 steps, BFGS (ired) 9 steps, RFO (ired) 5 steps (energy diff: &lt; 1e-5 Ha, geom diff: &lt; 1e-3 Å per coordinate)</li>
        </ul>
      </section>
      <section>
        <h3>Next Steps</h3>
        <ul class="fragmented-lists">
          <li>run calculations on all other systems</li>
          <li>calculate numerical Hessians</li>
          <!-- <li>compare structures with supersystem and isolated structures</li> -->
          <li>compute Stokes shifts</li>
        </ul>
      </section>

    </div>
  </div>

  <script src="dist/reveal.js"></script>
  <script src="plugin/notes/notes.js"></script>
  <script src="plugin/markdown/markdown.js"></script>
  <script src="plugin/highlight/highlight.js"></script>
  <script src="plugin/math/math.js"></script>
  <script>
    // More info about initialization & config:
    // - https://revealjs.com/initialization/
    // - https://revealjs.com/config/
    Reveal.initialize({
      hash: true,
      slideNumber: true,
      katex: {
        // local: 'node_modules/katex',
        trust: true,
      },
      autoAnimateEasing: 'cubic-bezier(.2,.8,.2,1)',

      // Learn about plugins: https://revealjs.com/plugins/
      plugins: [RevealMarkdown, RevealHighlight, RevealNotes, RevealMath.KaTeX]
    });
  </script>
  <script>
    Reveal.addEventListener("ready", function addFragmentToLists() {
      for (const listItem of document.querySelectorAll(".fragmented-lists li")) {
        listItem.classList.add("fragment");
      }
    });</script>
</body>

</html>